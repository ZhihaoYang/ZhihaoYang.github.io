[{"title":"CentOS安装MySQL8.0步骤和问题解决方法","url":"/2018/11/28/CentOS安装MySQL8-0步骤和问题解决方法/","content":"###### 1. 进入MySQL官网 [打开链接](http://dev.mysql.com/doc/mysql-yum-repo-quick-guide) 查看安装文档\n\n###### 2. 下载MySQL yum包（可以理解为mysql安装器），用来执行安装mysql命令。根据服务器Linux版本选择对应版本，[点击链接进入版本列表](https://dev.mysql.com/downloads/repo/yum/)\n\n2.1 复制rpm文件下载链接，直接下载到服务器缓存\n\n例如：\n``` bash\n\twget http://repo.mysql.com/mysql57-community-release-el7-10.noarch.rpm \n```\n\n\n###### 3. 安装yum包；需要使用命令 \n``` bash\n   sudo rpm -Uvh \"platform-and-version-specific-package-name\" \n```\n  \n  将 \"platform-and-version-specific-package-name\" 替换为你下载的rpm名\n  \n  例如：\n``` bash\n\tsudo rpm -Uvh mysql57-community-release-el7-10.noarch.rpm \n```\n\n###### 4. yum包安装成功后运行包命令安装mysql服务端 (该命令是运行mysql安装器，8.0版本有402M，安装时间与下载速度有很大关系)\n``` bash\n  \tyum install -y mysql-community-server\n```\n###### 5. 首次启动mysql\n``` bash\n  \tservice mysqld start\n```\n###### 6. 检查mysql运行状态（检测是否安装成功）\n``` bash\n  \tservice mysqld status\n```\n###### 7. 修改密码。mysql安装成功后会生成一个临时密码，修改密码之前首先需要获取默认密码\n\n7.1 获取默认密码\n``` bash\n\tgrep 'temporary password' /var/log/mysqld.log\n```\n7.2 输入临时密码登录mysql\n``` bash\n\tmysql -uroot -p\n```\n7.3 登入mysql之后才能修改密码，将'password'修改为 '你的密码'\n``` bash\n\tALTER USER 'root'@'localhost' IDENTIFIED BY 'password'\n```\n7.3.1 如果密码未包含字母数字和符号将会提示更改不成功，因为mysql的密码格式默认检测到不安全。如果不需要设置过于复杂，可以修改配置\n8.0之前版本需要输入\n  \n  修改复杂度\n``` bash\n\tset global validate_password_policy=0;\n```\n   修改长度\n``` bash\n\tset global validate_password_length=1;\n```\n\n8.0之后版本输入（可能是新版本语法和结构稍有调整吧）\n  \n  修改复杂度\n``` bash\n\tset global validate_password.policy=0;\n```\n   修改长度\n``` bash\n  set global validate_password.length=1;\n```\n\n7.3.2 修改配置之后再次修改密码即可成功\n\n``` bash\n\tALTER USER 'root'@'localhost' IDENTIFIED BY 'password'\n```\n\n###### 8. Mysql授权任意地址以root的用户名进行登陆\n8.1 创建用户并授权\n8.0之前版本:\n\n``` bash\n\tGRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY 'password' WITH GRANT OPTION;\n```\n\n8.0之后版本，因为新版的的mysql版本已经将创建账户和赋予权限的方式分开了，所以直接运行上面的命令会报语法错误，因此需要依次执行以下命令\n第一步：创建账户\n``` bash\n\tcreate user '用户名'@'访问主机' identified by '密码';\n```\n第二步：赋予权限\n``` bash\n\tgrant 权限列表 on 数据库 to '用户名'@'访问主机' ;(修改权限时在后面加with grant option)\n```\n\n8.2 授权结束并使配置生效\n``` bash\n\tFLUSH PRIVILEGES;\n```\n\n在使用数据库工具进行连接mysql时会出现mysql8 ：客户端连接caching-sha2-password问题，是由于虽然为mysql创建了可访问的用户名和密码但是并未设置加密方式，重新配置用户名和密码\n并附带上加密方式\n``` bash\n\tALTER USER 'username'@'ip_address' IDENTIFIED WITH mysql_native_password BY 'password';\n```"},{"title":"CentOS7安装iptables防火墙","url":"/2018/11/28/CentOS7安装iptables防火墙/","content":"CentOS7默认的防火墙不是iptables,而是firewalle.\n\n##### 一、安装iptable iptable-service\n\n###### 1.先检查是否安装了iptables\n```bash\n\tservice iptables status\n```\n###### 2.安装iptables\n```bash\n\tyum install -y iptables\n```\n###### 3.升级iptables（安装的最新版本则不需要）\n```bash\n\tyum update iptables\n```\n###### 4.安装iptables-services\n```bash\n\tyum install iptables-services\n```\n##### 二、禁用/停止自带的firewalld服务\n###### 1.停止firewalld服务\n```bash\n\tsystemctl stop firewalld\n```\n###### 2.禁用firewalld服务\n```bash\n\tsystemctl mask firewalld\n```\n###### 3、设置现有规则\n查看iptables现有规则\n```bash\n\tiptables -L -n\n```\n先允许所有,不然有可能会杯具\n```bash\n\tiptables -P INPUT ACCEPT\n```\n清空所有默认规则\n```bash\n\tiptables -F\n```\n清空所有自定义规则\n```bash\n\tiptables -X\n```\n所有计数器归0\n```bash\n\tiptables -Z\n```\n允许来自于lo接口的数据包(本地访问)\n```bash\n\tiptables -A INPUT -i lo -j ACCEPT\n```\n开放22端口\n```bash\n\tiptables -A INPUT -p tcp --dport 22 -j ACCEPT\n```\n开放21端口(FTP)\n```bash\n\tiptables -A INPUT -p tcp --dport 21 -j ACCEPT\n```\n开放80端口(HTTP)\n```bash\n\tiptables -A INPUT -p tcp --dport 80 -j ACCEPT\n```\n开放443端口(HTTPS)\n```bash\n\tiptables -A INPUT -p tcp --dport 443 -j ACCEPT\n```\n允许ping\n```bash\n\tiptables -A INPUT -p icmp --icmp-type 8 -j ACCEPT\n```\n允许接受本机请求之后的返回数据 RELATED,是为FTP设置的\n```bash\n\tiptables -A INPUT -m state --state  RELATED,ESTABLISHED -j ACCEPT\n```\n其他入站一律丢弃\n```bash\n\tiptables -P INPUT DROP\n```\n所有出站一律绿灯\n```bash\n\tiptables -P OUTPUT ACCEPT\n```\n所有转发一律丢弃\n```bash\n\tiptables -P FORWARD DROP\n```\n\n4、其他规则设定\n#如果要添加内网ip信任（接受其所有TCP请求）\n```bash\n\tiptables -A INPUT -p tcp -s 45.96.174.68 -j ACCEPT\n```\n 过滤所有非以上规则的请求\n```bash\n\tiptables -P INPUT DROP\n```\n要封停一个IP，使用下面这条命令：\n```bash\n\tiptables -I INPUT -s ***.***.***.*** -j DROP\n```\n要解封一个IP，使用下面这条命令:\n```bash\n\tiptables -D INPUT -s ***.***.***.*** -j DROP\n```\n5、保存规则设定\n#保存上述规则\n```bash\n\tservice iptables save\n```\n\n6、开启iptables服务\n注册iptables服务，相当于以前的  ``` chkconfig iptables on ```\n```bash\n\tsystemctl enable iptables.service\n```\n开启服务\n```bash\n\tsystemctl start iptables.service\n```\n查看状态\n```bash\n\tsystemctl status iptables.service\n```\n7、映射端口（如将mysql默认的3306端口映射成1306对外提供服务）\n```bash\n\tiptables -t mangle -I PREROUTING -p tcp --dport 1306 -j MARK --set-mark 883306\n```\n\n```bash\n\tiptables -t nat -I PREROUTING -p tcp --dport 1306 -j REDIRECT --to-ports 3306\n```\n```bash\n\tiptables -I INPUT -p tcp --dport 3306 -m mark --mark 883306 -j ACCEPT\n```","tags":["iptables","centos防火墙"],"categories":["CentOS","Linux"]},{"title":"Hello World","url":"/2018/11/28/hello-world/","content":"Welcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/deployment.html)\n"}]